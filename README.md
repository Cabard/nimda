#-NetBot-

## Оглавление
- [Информация](#info)
- [Установка](#install)
- [Публикация зависимостей в Laravel](#composer-publish-info)
- [UML](#uml)
- [Eloquent модели](#models)
- [Модули](#modules)
    - [Реализация](#modules-realization)
    - [Пример вызова](#modules-call)
    - [Реализованные модули](#modules-list)
- [Инструменты](#tools)
- [API](#api)


## <a name="info">Информация</a>
Документация об функционале composer-пакета для Laravel.
Концепция пакета в том, что он предоставляет функционал быстро и гибко создавать чат-ботов
для разных социальных сетей и других сервисов по взаимодействию с пользователями по средствам диалога с ними.
Система достаточна гибкая для добавления новых сервисов и команд бота.


## <a name="install">Установка</a>
Пакет устанавливается в Laravel
### <a name="install-package">Установка пакета</a>
#### <a name="install-compoesr">Установка через Composer</a>
Т.к. пакет не находится в публичной части и не зарегистрирован среди пакетов Composer, а
располагается в приватном репозитории GitHub, то нужно совершить следующие шаги:
- В composer.json вашего проекта нужно вписать 
```json
"require": [
    ...,
    "cabard/netbot": "dev-master"
    ....
]
```
- Так же в composer.json добавить перед ключом `require` (см. выше)
```json
"repositories": [
    ...
    {
        "type": "vcs",
        "url": "https://github.com/Cabard/netbot"
    }
    ...
]
```
- Обновить композер, введя команду в консоли
```bash
composer update
```
- Т.к. пакет находится в приватном доступе, то Composer потребует ввести 
  токен для доступа и так же выведет информацию о том, как его получить. 
  Токен необходимо ввести в консоль. После ввода токена пакет установится в проекте.
- В консоли ввести команду которая опубликует необходимые зависимости в проекте [Подробнее](#composer-publish-info).
```bash
php artisan vendor:publish --provider="Cabard\Netbot\NetbotServiceProvider"
```
опубликовать ковфиг, паблик
- Запустить миграции
```bash
php artisan migrate
```

#### <a name="modules">Публикация зависимостей в Laravel</a>
Пакет публикует: 
##### Миграции
Все наименования таблиц начинается с`cnb_` и имеют вид: `cnb_{table_name}`
##### Маршрутизация
По умолчанию маршруты публикуются с припиской `cnb.` и префиксом в запросе `cnb`.
Для изменения этих параметров нужно внести изменения в конфиг-файл пакета, который так же публикуется.
Так же все маршруты защищены посредником (middleware) см. `\Cabard\Netbot\Http\Middleware\AccessToBot`
##### Конфиг-файл
Публикуется конфиг-файл `conf.php`. Все параметры описаны внутри файла.


### <a name="install-compoesr">Дополнительные параметры для установки</a>
- необходимо развернуть очереди, поддерживающие `блокировки`

## <a name="uml">UML</a>
UML пока не перерисованно //TODO

## <a name="models">Eloquent модели</a>
- `Bot` - хранятся сами боты.
- `BotCommand` - Команды бота.
  - Поля:
    - *command* - команда. Данные для поиска, основанные на действии пользователя.
    - *type* - отвечает за то, как бот будет воспринимать команды.
      - `greeting` - приветствие. Имеет наивысший приоритет. Вызывается только тогда, когда пользователь написал первое сообщение боту. `command` будет проигнорирована.
      - `cmd` - команда. Вторичный приоритет. Проверяется в первую очередь. Бот реагирует на нее когда пользователь ввел текст из поля `command`
      - `cp` - чат-позиция. Проверяется после команды. Реагирует, если поле `command` совпадает с полем `chat_position` в модели `User`.
      - `default` - по умолчанию. Вызывается после всех проверок, если ничего не было найдено.
    - *data* - Действие бота. Проверяется является ли значением неймспейсом класса или же нет. Если это класс, то вызывается этот класс и в него передается объект класса `\Cabard\Netbot\Tools\Handler()`. Пример написание класса `\Name\Space\Class::method`, где `method` - метод вызываемого класса. 
      По умолчанию `botReaction`. Если же значение `data` не воспринимается как класс, то оно воспринимается как ответ пользователю и будет ему отправлено.

## <a name="modules">Модули</a>
### <a name="modules-realization">Реализация</a>
### <a name="modules-call">Пример вызова</a>
### <a name="modules-list">Реализованные модули</a>
## <a name="tools">Инструменты</a>
## <a name="api">API</a>
